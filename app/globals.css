@import "tailwindcss";

@layer base {
  /* Custom Font - AlternateGothicW01-No3 (完全复刻原项目) */
  @font-face {
    font-family: "AlternateGothicW01-No3";
    src: url("/assets/fonts/d204d256-fb7f-488b-a5f2-57979585e00a.eot?#iefix");
    src:
      url("/assets/fonts/d204d256-fb7f-488b-a5f2-57979585e00a.eot?#iefix")
        format("eot"),
      url("/assets/fonts/836ee743-8a38-45fb-8076-f78de89ed923.woff2")
        format("woff2"),
      url("/assets/fonts/6e86a433-85a2-40a6-8dc7-58cc16a6cb9b.woff")
        format("woff"),
      url("/assets/fonts/72fb6a94-41e4-4db6-b19b-88ad54f05d97.ttf")
        format("truetype"),
      url("/assets/fonts/e3670e54-4d1a-499a-a84b-cf19198f20a5.svg#e3670e54-4d1a-499a-a84b-cf19198f20a5")
        format("svg");
    font-display: swap;
  }
}

@layer base {
  /* 字体类 - 确保正确应用 */
  .font-primary {
    font-family: Times, serif;
  }

  .font-secondary {
    font-family: "AlternateGothicW01-No3", sans-serif;
  }

  .font-tertiary {
    font-family: Helvetica, sans-serif;
  }

  .font-brand {
    font-family: "Playfair Display", Times, serif;
  }

  /* 字母间距变化 */
  .tracking-variation {
    letter-spacing: 3px;
  }

  /* CSS Variables - 原项目颜色系统 */
  :root {
    --background: #fffff5;
    --foreground: #000;
    --primary: #000;
    --secondary: #f76c5e;
    --light-grey: #eeeee5;
    --dark-grey: #222222;
    --error: tomato;
    --border: #d4d4d3;
  }

  /* Base Styles */
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  html {
    font-size: 62.5%; /* 10px base for REM calculations */
    height: 100%;
    scroll-behavior: smooth;
  }

  body {
    height: 100%;
    background-color: var(--background);
    color: var(--foreground);
    font-family: Times, serif;
    font-size: 2rem; /* 20px */
    font-weight: 300;
    line-height: 1.5;
    display: flex;
    flex-direction: column;
  }

  /* 隐藏 aria-hidden 元素 */
  [aria-hidden="true"] {
    display: none;
  }

  /* Link Styles */
  a {
    color: inherit;
    text-decoration: none;
    transition: opacity 0.2s ease-out;
  }

  a:hover {
    opacity: 0.6;
  }

  /* Code Styles */
  code {
    font-family: Monaco, Consolas, Menlo, monospace;
  }

  p code,
  li code {
    background-color: var(--light-grey);
    font-size: 0.75em;
    padding: 5px 8px;
  }

  /* Selection Color */
  ::selection {
    background-color: var(--secondary);
    color: white;
  }
}

@layer components {
  /* Clearfix utility */
  .cf::after {
    content: "";
    display: table;
    clear: both;
  }

  /* Drop Cap - 首字下沉 */
  .drop-cap::first-letter {
    font-family: "AlternateGothicW01-No3", sans-serif;
    float: left;
    line-height: 50px;
    font-size: 120px;
    margin: 23px 6px 0px 0px;
  }

  @media (min-width: 800px) {
    .drop-cap::first-letter {
      line-height: 53px;
      font-size: 130px;
      margin: 33px 6px 0px -5px;
    }
  }

  /* Feature Title 样式 */
  .feature-title {
    display: block;
    width: 100%;
    text-align: center;
    font-family: "AlternateGothicW01-No3", sans-serif;
    font-size: 95px;
    font-weight: bold;
  }

  .feature-title__full {
    display: block;
    font-family: "AlternateGothicW01-No3", sans-serif;
    font-weight: bold;
    font-size: 32px; /* 小屏幕 */
    line-height: 1.1;
    text-transform: uppercase;
  }

  @media (min-width: 480px) {
    .feature-title__full {
      font-size: 48px; /* 中等屏幕 */
    }
  }

  @media (min-width: 800px) {
    .feature-title__full {
      font-size: 0; /* 桌面端隐藏，使用动态大小的 parts */
      line-height: 0;
    }
  }

  .feature-title__part {
    display: inline-block;
    white-space: nowrap;
    text-transform: uppercase;
    line-height: 0.78;
    font-family: "AlternateGothicW01-No3", sans-serif;
    font-weight: bold;
    opacity: 0;
    transition: opacity 0.3s ease-out;
  }

  @media (max-width: 799px) {
    .feature-title__part {
      display: none !important;
    }
  }

  /* Feature Title Animation */
  @keyframes fadeInFeatureTitle {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
}

@layer utilities {
  /* Responsive Font Utility - 基于视口的流体字体 */
  .responsive-font {
    font-size: clamp(var(--min-size), var(--responsive-size), var(--max-size));
  }

  /* Column utilities for featured posts */
  .columns-2 {
    column-count: 2;
    column-gap: 1.5rem;
  }
}

/* 额外的布局样式 */
@layer components {
  /* Masthead 样式调整 */
  .masthead-bar__face {
    position: relative;
    top: 0;
    width: 100%;
    height: 100%;
  }

  .masthead-bar__search-input:focus {
    background-color: var(--light-grey);
  }

  /* Search Button 动效 */
  .search-button {
    cursor: pointer;
  }

  .search-button__icon {
    display: inline-block;
    width: 20px;
    height: 20px;
    transform-origin: center;
    vertical-align: middle;
    transition: transform 100ms ease-out;
  }

  .search-button:hover .search-button__icon {
    transform: scale(1.1);
  }

  .search-button__label {
    display: none;
    text-transform: none;
    font-size: 14px;
    vertical-align: middle;
  }

  @media (min-width: 800px) {
    .search-button__label {
      display: inline;
    }
  }

  /* Post 样式 */
  .post__title {
    line-height: 1.2;
  }

  /* Constrain 样式 */
  .constrain {
    max-width: 1640px;
    margin-left: auto;
    margin-right: auto;
  }

  .constrain--padding {
    max-width: 1700px;
    padding-left: 30px;
    padding-right: 30px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Post--full 样式 */
  .post--full .constrain {
    padding-left: 20px;
    padding-right: 20px;
  }

  /* Post Meta 样式 */
  .post__meta {
    text-align: center;
  }

  @media (min-width: 800px) {
    .post__meta {
      margin-top: 20px;
    }
  }

  .post-meta--emphasis {
    max-width: 700px;
    margin: 0 auto;
    padding: 35px;
    font-family: Times, serif;
    font-size: 16px;
    line-height: 1.3;
  }

  .post-meta--emphasis a {
    text-decoration: underline;
    transition: opacity 0.2s ease-out;
  }

  .post-meta--emphasis a:hover {
    opacity: 0.6;
  }

  /* 文章正文样式 - 完全复刻原版 */
  .post__body {
    overflow-wrap: break-word;
    word-wrap: break-word;
  }

  /* Body-text 样式 */
  .body-text p,
  .body-text li,
  .body-text details {
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
    padding-left: 35px;
    padding-right: 35px;
    font-size: 20px;
    line-height: 1.6;
    margin-bottom: 25px;
  }

  @media (min-width: 800px) {
    .body-text p,
    .body-text li,
    .body-text details {
      font-size: 24px;
      text-align: justify;
    }
  }

  /* Drop Cap 效果 - 第一个段落的首字母（排除引用文本） */
  .body-text p:first-of-type:not(blockquote p)::first-letter {
    float: left;
    font-family: "AlternateGothicW01-No3", sans-serif;
    font-size: 130px;
    line-height: 53px;
    margin: 33px 6px 0px -5px;
    font-weight: normal;
  }

  @media (max-width: 799px) {
    .body-text p:first-of-type:not(blockquote p)::first-letter {
      font-size: 80px;
      line-height: 32px;
      margin: 20px 4px 0px -3px;
    }
  }

  /* 确保引用文本内的段落不使用 Drop Cap */
  .body-text blockquote p::first-letter {
    float: none;
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    margin: 0;
    font-weight: inherit;
  }

  .body-text li p {
    display: inline;
    padding: 0;
    margin-bottom: 0;
  }

  .body-text li ol,
  .body-text li ul {
    margin-top: 15px;
  }

  .body-text li + li {
    margin-top: 15px;
  }

  .body-text strong {
    font-weight: bold;
  }

  .body-text em {
    font-style: italic;
  }

  .body-text a {
    text-decoration: underline;
    transition: opacity 0.2s ease-out;
  }

  .body-text a:hover {
    opacity: 0.6;
  }

  .body-text ul {
    list-style-type: disc;
    list-style-position: inside;
  }

  .body-text ol {
    list-style-type: decimal;
    list-style-position: inside;
  }

  /* Preface 样式 */
  .preface {
    max-width: 700px;
    margin: 0 auto 25px auto;
    padding: 35px;
    background-color: var(--light-grey);
  }

  .preface p {
    margin-bottom: 15px;
    font-size: 20px;
    line-height: 1.6;
  }

  @media (min-width: 800px) {
    .preface p {
      font-size: 24px;
    }
  }

  .preface ul {
    margin-left: 20px;
  }

  .preface li {
    margin-bottom: 8px;
    font-size: 20px;
    line-height: 1.6;
  }

  @media (min-width: 800px) {
    .preface li {
      font-size: 24px;
    }
  }

  /* Audio Player 样式 */
  .audio-player {
    margin-bottom: 25px;
  }

  .audio-player__inner {
    max-width: 700px;
    margin: 0 auto;
    padding: 35px;
    background-color: var(--light-grey);
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .audio-player__icon {
    width: 32px;
    height: 32px;
  }

  .audio-player__label {
    font-size: 16px;
  }

  /* 文章内容标题样式 */
  .body-text h2 {
    font-family: "Playfair Display", Times, serif;
    font-size: 32px;
    font-weight: 700;
    max-width: 700px;
    margin: 45px auto 15px auto;
    padding-left: 35px;
    padding-right: 35px;
  }

  .body-text h3 {
    font-family: "Playfair Display", Times, serif;
    font-size: 24px;
    font-weight: 700;
    max-width: 700px;
    margin: 45px auto 15px auto;
    padding-left: 35px;
    padding-right: 35px;
  }

  /* 代码样式 */
  .body-text li code,
  .body-text p code {
    font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
    background-color: var(--light-grey);
    font-size: 0.75em;
    padding: 5px 8px;
  }

  /* 图片样式 */
  .body-text img {
    display: block;
    margin: 0 auto;
    max-width: 100%;
  }

  /* 引用样式 - Pull quote */
  .body-text :not(blockquote) > blockquote,
  .post__content :not(blockquote) > blockquote,
  .post__body :not(blockquote) > blockquote,
  article :not(blockquote) > blockquote,
  blockquote:not(blockquote blockquote) {
    max-width: 700px;
    margin: 75px auto;
  }

  .body-text :not(blockquote) > blockquote > p,
  .post__content :not(blockquote) > blockquote > p,
  .post__body :not(blockquote) > blockquote > p,
  article :not(blockquote) > blockquote > p {
    font-style: italic !important;
    text-align: center !important;
    font-size: 32px !important;
    border-left: 2px solid black;
    padding-left: 35px;
    padding-right: 35px;
    margin: 0 !important;
    max-width: none;
  }

  /* 更通用的 blockquote 样式 - 确保所有直接 blockquote 都有正确样式 */
  blockquote:not(blockquote blockquote) > p {
    font-style: italic !important;
    text-align: center !important;
    font-size: 32px !important;
    border-left: 2px solid black;
    padding-left: 35px;
    padding-right: 35px;
    margin: 0 !important;
  }

  /* 引用样式 - Citations (嵌套引用) */
  .body-text blockquote > blockquote {
    max-width: 700px;
    margin: 35px auto 25px auto;
    padding: 35px;
    position: relative;
    font-style: italic;
  }

  .body-text blockquote > blockquote > p {
    background-color: var(--light-grey);
    padding: 0 20px 20px 20px;
    margin-bottom: 0;
    font-style: italic;
  }

  .body-text blockquote > blockquote > p:first-of-type {
    padding-top: 40px;
  }

  .body-text blockquote > blockquote > p:first-of-type::before {
    content: "\201C";
    position: absolute;
    top: -22px;
    left: 0;
    font-size: 160px;
    font-weight: bold;
    font-family: Times, serif;
    line-height: 1em;
  }

  /* 表格样式 */
  .body-text table {
    max-width: 700px;
    margin: 0 auto 25px auto;
    padding-left: 35px;
    padding-right: 35px;
  }

  .body-text th {
    font-weight: bold;
  }

  .body-text td,
  .body-text th {
    background-color: var(--light-grey);
    border: 3px solid var(--background);
    padding: 10px;
  }

  .post__body h3 {
    font-family: "Playfair Display", Times, serif;
    font-size: 24px;
    font-weight: 700;
    margin-top: 45px;
    margin-bottom: 15px;
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
  }

  .post__body ul,
  .post__body ol {
    margin-bottom: 25px;
    list-style-position: inside;
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
    padding-left: 35px;
    padding-right: 35px;
  }

  .post__body ul {
    list-style-type: disc;
  }

  .post__body ol {
    list-style-type: decimal;
  }

  .post__body li + li {
    margin-top: 15px;
  }

  .post__body a {
    color: inherit;
    text-decoration: underline;
    transition: opacity 0.2s ease-out;
  }

  .post__body a:hover {
    opacity: 0.6;
  }

  .post__body blockquote {
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
    padding-left: 35px;
    padding-right: 35px;
    font-style: italic;
    text-align: center;
    font-size: 32px;
    border-left: 2px solid black;
    margin-top: 75px;
    margin-bottom: 25px;
  }

  .post__body img {
    display: block;
    margin: 0 auto;
    max-width: 100%;
  }

  /* Main 内容区域动效 */
  .main {
    transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    flex: 1 0 auto;
    margin-top: 25px;
  }

  /* Post transition effects - 支持浮现动画 */
  .js-post {
    /* 默认状态，准备接受动画 */
    opacity: 1;
    transform: translateY(0) scale(1);
  }

  a > .js-post:hover {
    transform: translateY(-3px) scale(1);
    opacity: 0.6;
    transition: transform 0.3s ease, opacity 0.3s ease;
  }

  /* 新文章浮现动画的初始状态 */
  .js-post.fade-in-initial {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }

  /* 新文章浮现动画的最终状态 */
  .js-post.fade-in-final {
    opacity: 1;
    transform: translateY(0) scale(1);
  }

  /* Masonry 布局过渡效果 - 匹配原项目的 stagger 填充效果 */
  .js-posts {
    transition: height 0.2s ease;
  }

  .js-posts .js-post {
    /* 让 Masonry 完全控制动画 */
  }

  /* Search Results 动效 */
  .search-results {
    transition: max-height 0s linear 0s, opacity 0.2s ease-out 0s;
    max-height: 0;
    opacity: 0;
    overflow: hidden;
  }

  .search-results--visible {
    max-height: 15000px;
    opacity: 1;
    transition: max-height 0s linear 0.3s, opacity 0.2s ease-out 0.35s;
  }

  /* Small Card 样式 */
  .small-card {
    display: block;
    padding: 20px;
    background-color: var(--light-grey);
    transition: transform 0.2s ease-out, opacity 0.2s ease-out;
  }

  @media (min-width: 800px) {
    .small-card {
      display: inline-block;
    }
  }

  .small-card:hover {
    transform: translateY(-3px);
    opacity: 0.6;
  }

  .small-card__pre {
    font-size: 13px;
    text-transform: uppercase;
    margin-bottom: 10px;
  }

  .small-card__title {
    font-weight: bold;
  }

  /* Search Result 样式 */
  .search-result {
    margin: 20px;
  }

  @media (min-width: 800px) {
    .search-result {
      margin: 20px 10px 10px 20px;
    }
  }

  /* Masonry Grid 样式 */
  .masonry-grid {
    display: flex;
    margin-left: -30px;
    width: auto;
  }

  .masonry-grid_column {
    padding-left: 30px;
  }

  .masonry-grid_column > * {
    margin-bottom: 0;
  }

  /* CTA Button Styles - 完美复刻原项目 */
  .cta {
    position: relative;
    display: inline-block;
    padding: 10px;
    border: 1px solid black;
    border-radius: 0;
    font-size: 14px;
    font-weight: bold;
    text-transform: uppercase;
    background: transparent;
    cursor: pointer;
    transition: background-color 0.3s ease-out, color 0.3s ease-out, transform 0.3s ease-out;
    text-decoration: none;
  }

  .cta:hover {
    background-color: black;
    color: white;
  }

  .cta--progress::before {
    position: absolute;
    content: '...';
    background-color: var(--background);
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    line-height: 30px;
    font-size: 1.5em;
    letter-spacing: 3px;
    color: var(--primary);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Paginator Styles - 完美复刻原项目 */
  .paginator {
    max-width: calc(1640px + 2 * 30px + 12px);
    margin: 0 auto;
    padding: 0 30px;
  }

  .paginator__inner {
    position: relative;
    text-align: center;
    margin-bottom: 25px;
  }

  .paginator__inner::before {
    content: " ";
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    border-bottom: 1px solid black;
    z-index: -1;
  }

  .paginator__button-wrapper {
    display: inline-block;
    padding: 0 10px;
    background-color: var(--background);
  }
}
